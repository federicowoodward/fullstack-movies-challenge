(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[225],{1505:function(e,t,r){Promise.resolve().then(r.bind(r,3484))},3484:function(e,t,r){"use strict";r.d(t,{default:function(){return p}});var s=r(9566),a=r(3157),l=r.n(a),n=r(8590);function i(e){let{data:t,columns:r,pageSize:a=10,emptyLabel:i="No records found"}=e,[o,d]=(0,n.useState)(1),c=Math.max(1,Math.ceil(t.length/a));(0,n.useEffect)(()=>{d(1)},[t.length,a]);let u=(0,n.useMemo)(()=>{let e=(o-1)*a;return t.slice(e,e+a)},[t,o,a]),m=e=>{d(Math.min(Math.max(1,e),c))};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border border-slate-200",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,s.jsx)("thead",{className:"bg-slate-50",children:(0,s.jsx)("tr",{children:r.map(e=>(0,s.jsx)("th",{className:l()("px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600",e.className),children:e.header},e.key))})}),(0,s.jsx)("tbody",{className:"divide-y divide-slate-200 bg-white",children:0===u.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:r.length,className:"px-4 py-6 text-center text-sm text-slate-500",children:i})}):u.map((e,t)=>(0,s.jsx)("tr",{className:"hover:bg-slate-50",children:r.map(t=>{let r=e[t.key];return(0,s.jsx)("td",{className:l()("px-4 py-3 text-sm text-slate-800",t.className),children:t.render?t.render(e):String(null!=r?r:"")},t.key)})},t))})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[(0,s.jsxs)("div",{children:["Page ",o," of ",c]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{className:"rounded border border-slate-200 px-3 py-1 hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>m(o-1),disabled:1===o,children:"Previous"}),(0,s.jsx)("button",{className:"rounded border border-slate-200 px-3 py-1 hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>m(o+1),disabled:o===c,children:"Next"})]})]})]})}var o=r(8083),d=r(9039);let c=(0,n.forwardRef)((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsx)("select",{ref:t,className:l()("w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",r),...n,children:a})});function u(e){let{genre:t="",sort:r,onGenreChange:a,onSortChange:l,onReset:n}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-3 rounded-lg border border-slate-200 bg-white p-4 shadow-sm md:flex-row md:items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"mb-1 block text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Genre"}),(0,s.jsx)(d.I,{value:t,onChange:e=>a(e.target.value),placeholder:"You must put the genre exactly as it looks in the list for result to be shown."})]}),(0,s.jsxs)("div",{className:"w-full md:w-48",children:[(0,s.jsx)("label",{className:"mb-1 block text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Sort by"}),(0,s.jsxs)(c,{value:null!=r?r:"",onChange:e=>l(e.target.value?e.target.value:void 0),children:[(0,s.jsx)("option",{value:"",children:"None"}),(0,s.jsx)("option",{value:"title",children:"Title"}),(0,s.jsx)("option",{value:"year",children:"Year"})]})]}),(0,s.jsx)("div",{className:"flex justify-end md:ml-auto",children:(0,s.jsx)(o.z,{type:"button",variant:"secondary",onClick:()=>null==n?void 0:n(),className:"w-full md:w-auto",children:"Reset"})})]})}c.displayName="Select";var m=r(5538),h=r(6555),x=r(8686);let f=Array.from({length:5});function p(){var e,t,r;let a=(0,h.useSearchParams)(),l=(0,h.useRouter)(),o=(0,h.usePathname)(),d=null!==(e=a.get("genre"))&&void 0!==e?e:"",c=null!==(t=a.get("sort"))&&void 0!==t?t:void 0,p=(0,n.useMemo)(()=>(0,m.tD)({genre:d||void 0,sort:c}),[d,c]),{data:b,error:v,isLoading:g}=(0,x.ZP)(p),y=(0,n.useCallback)((e,t)=>{let r=new URLSearchParams(a.toString());t&&t.length>0?r.set(e,t):r.delete(e);let s=r.toString();l.replace(s?"".concat(o,"?").concat(s):o)},[o,l,a]),j=null!==(r=null==b?void 0:b.data)&&void 0!==r?r:[];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Movies"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Search and filter through the catalog."})]})}),(0,s.jsx)(u,{genre:d,sort:c,onGenreChange:e=>y("genre",e),onSortChange:e=>y("sort",null!=e?e:""),onReset:()=>l.replace(o)}),g?(0,s.jsx)("div",{className:"space-y-3",children:f.map((e,t)=>(0,s.jsx)("div",{className:"skeleton h-16 w-full"},t))}):v?(0,s.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:v.message||"Unable to load movies"}):(0,s.jsx)(i,{data:j,emptyLabel:"No movies found",columns:[{key:"id",header:"ID",className:"w-16"},{key:"title",header:"Title"},{key:"genre",header:"Genre"},{key:"year",header:"Year",className:"w-24"},{key:"director",header:"Director",render:e=>{var t,r;return null!==(r=null===(t=e.director)||void 0===t?void 0:t.name)&&void 0!==r?r:"�"}},{key:"actors",header:"Actors",render:e=>e.actors.map(e=>e.name).join(", ")||"�"}]})]})}},8083:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(9566),a=r(8590),l=r(3157),n=r.n(l);let i={primary:"bg-primary text-white hover:bg-blue-600",secondary:"bg-slate-200 text-slate-900 hover:bg-slate-300",danger:"bg-danger text-white hover:bg-red-700"},o=(0,a.forwardRef)((e,t)=>{let{className:r,variant:a="primary",loading:l=!1,disabled:o,children:d,...c}=e;return(0,s.jsxs)("button",{ref:t,className:n()("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-colors",i[a],(o||l)&&"opacity-60 cursor-not-allowed",r),disabled:o||l,...c,children:[l&&(0,s.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),d]})});o.displayName="Button"},9039:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var s=r(9566),a=r(8590),l=r(3157),n=r.n(l);let i=(0,a.forwardRef)((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("input",{ref:t,className:n()("w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-900 placeholder-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",r),...a})});i.displayName="Input"},5538:function(e,t,r){"use strict";r.d(t,{SC:function(){return a},WD:function(){return i},tD:function(){return n}}),r(6555);class s extends Error{constructor(){super("Unauthorized"),this.name="UnauthorizedError"}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=()=>fetch(e,{...t,credentials:"include",headers:{...t.headers,...t.body?{"Content-Type":"application/json"}:{}}}),a=await r();if(401!==a.status||204===(await fetch("/api/auth/refresh",{method:"POST",credentials:"include"})).status&&401!==(a=await r()).status)return a;throw window.location.href="/login",new s}async function l(e,t){let r=await a(e,t),s=await r.text(),l=s?JSON.parse(s):{};if(!r.ok){var n;let e=Error(null!==(n=null==l?void 0:l.message)&&void 0!==n?n:"Request failed");throw e.status=r.status,e}return l}function n(e){let t=new URLSearchParams;(null==e?void 0:e.genre)&&t.set("genre",e.genre),(null==e?void 0:e.sort)&&t.set("sort",e.sort);let r=t.toString();return r?"/api/movies?".concat(r):"/api/movies"}async function i(e){return await l("/api/movies",{method:"POST",body:JSON.stringify(e)})}}},function(e){e.O(0,[43,977,844,744],function(){return e(e.s=1505)}),_N_E=e.O()}]);